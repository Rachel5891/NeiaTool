<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>NEIA Tool - Informed Consent</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; padding: 20px; line-height: 1.5; }
    h1, h2 { color: #333; }
    .hidden { display: none; } 
    .button { background: #007bff; color: white; padding: 10px 15px; border: none; cursor: pointer; margin-top: 10px; border-radius:4px; }
    .button:hover { background: #0056b3; }
    .dev-mode { display: flex; justify-content: flex-end; }
    .dev-button { background: #aaa; margin-top: 0; margin-right: 20px; border-radius:4px; }

    .training-instructions, .question-box, .section, .final-score {
      background: #ffffff;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
    }
    .training-instructions h2, .question-box h2 { margin-top: 0; color: #003366; }
    .training-instructions h3 { color: #005f99; margin-top: 20px; }
    .training-instructions ol { margin-left: 20px; }
    .training-instructions ol li { margin: 10px 0; }
    .training-instructions ol li ul { margin-top: 8px; margin-left: 20px; list-style-type: disc; }
    .question-box { border: 1px solid #ddd; }
    .question-box ul { margin-left: 20px; }

    .rating-desc {
      font-size: 14px;
      background: #f1f7ff;
      padding: 10px;
      margin-top: 8px;
      border-left: 4px solid #007acc;
      border-radius: 4px;
    }
    select { font-size: 16px; margin-top: 10px; padding: 6px; border-radius:4px; }
    .feedback {
      padding: 10px;
      margin-top: 10px;
      border-left: 4px solid;
      border-radius: 5px;
      display: none;
    }
    .feedback.correct { background-color: #e8f5e9; border-color: #4caf50; }
    .feedback.incorrect { background-color: #fdecea; border-color: #f44336; }

    .ref-box {
      font-size: 13px;
      background: #fffbe6;
      padding: 10px;
      border-left: 4px solid #ffcc00;
      border-radius: 4px;
      margin-top: 10px;
    }
    table { width: 100%; border-collapse: collapse; margin-top: 8px; font-size: 13px; }
    th, td { border: 1px solid #ccc; padding: 6px; }
    th { background: #eee; }
  </style>
</head>
<body>
  <!-- üîπ Informed Consent Section -->
  <div id="consentSection">
    <h1>NEIA Pilot Study - Informed Consent</h1>
    <div class="consent-box">
      <h2>Purpose of the Study</h2>
      <p>The purpose of this pilot research study is to evaluate the effectiveness and accuracy of a newly developed instrument designed to validate NCLEX-style questions. This will involve comparing your assessment scores with those generated by a custom artificial intelligence (AI) scoring model.</p>

      <h2>What Does the Study Involve?</h2>
      <ul>
        <li>Use the instrument to assess a set of NCLEX-style questions.</li>
        <li>Provide scores based on the criteria outlined in the instrument.</li>
        <li>Allow your scores to be compared to those generated by our custom AI model to assess the instrument's reliability and validity.</li>
        <li>As a token of our appreciation for your time, you will receive a $50 gift card after you complete the survey in its entirety. Receipt of the gift card is contingent on submitting a fully completed survey. Your participation is entirely voluntary, and you may withdraw at any point without penalty or loss of benefits. However, to be eligible for the gift card, you must finish and submit the survey. Please note that any information you provide will remain confidential and will be used solely for the purposes of this research study.</li>
      </ul>

      <h2>Confidentiality & Risks</h2>
      <p>There are minimal risks, including the loss of confidentiality. Every effort will be made to maintain confidentiality. Your de-identified information may be shared with other researchers without your additional informed consent.</p>

      <h2>Contact Information</h2>
      <p>The Principal Investigator (PI) of this project is Dr. Anshul Kumar (<a href="mailto:akumar@mghihp.edu">akumar@mghihp.edu</a>).</p>
      <p>The co-investigator is Dr. Rachel Cox Simms (<a href="mailto:rlcox@mghihp.edu">rlcox@mghihp.edu</a>).</p>
      <p>If you would like to speak to someone not involved in this research about your rights as a research subject, or any concerns or complaints you may have about the research, contact the Mass General Brigham IRB at (857) 282-1900.</p>

      <h2>Agreement to Participate</h2>
      <p><strong>By clicking "Submit," you agree to participate in this study. You will receive 5 randomly assigned NCLEX questions. If you do not complete all 5 in one sitting, you can return using the same link as long as you do not clear your cache.</strong></p>

      <button type="button" class="button" onclick="startSurvey()">Submit</button>
    </div>
  </div>

  <!-- üîπ Training Walkthrough (Hidden Until Consent) -->
  <div id="walkthroughSection" class="hidden">
    <section class="training-instructions">
      <h2>NEIA Training Instructions: Sample Walkthrough</h2>
      <p>Welcome to your <strong>NEIA training!</strong> In this exercise, you‚Äôll use our <em>interactive sample walkthrough</em> to practice evaluating NCLEX-style questions. This is <strong>not</strong> a quiz‚Äîyour goal is to learn how to spot strengths and flaws in item construction, not simply to pick the correct answer.</p>
      <h3>What You‚Äôll Do</h3>
      <ol>
        <li><strong>View one sample question</strong> presented in the walkthrough.</li>
        <li>
          <strong>Rate five components</strong> of that question using the dropdowns  
          <em>(this walkthrough covers <strong>5 of the 14</strong> total NEIA components):</em>
          <ul>
            <li>Stem Clarity</li>
            <li>Correct Answer Accuracy</li>
            <li>Distractor Plausibility</li>
            <li>Terminology Accuracy</li>
            <li>NCLEX-RN Test Plan Alignment</li>
          </ul>
        </li>
        <li><strong>Read immediate feedback</strong> after each rating to see how closely your choice matches the expert‚Äôs rating and learn the rationale.</li>
        <li><strong>Reveal the final ‚Äúexpert‚Äù score</strong> to confirm your overall judgment and compare notes.</li>
      </ol>
    </section>

    <div class="question-box">
      <h2>Sample NCLEX-Style Question</h2>
      <p><strong>Stem:</strong> A 54-year-old patient presents to the clinic with fatigue, weight gain, dry skin, and cold intolerance. Laboratory results show an elevated TSH level and low free T4. Based on these findings, which condition is the most likely diagnosis?</p>
      <ul>
        <li>A. Grave‚Äôs disease</li>
        <li>B. Hashimoto‚Äôs thyroiditis</li>
        <li>C. Subclinical hypothyroidism</li>
        <li>D. Cushing‚Äôs syndrome</li>
      </ul>
      <p><em>Answer: B. Hashimoto‚Äôs thyroiditis</em></p>
    </div>

    <script>
      const expert = {
        clarity: '3',
        accuracy: '3',
        distractors: '3',
        terminology: '1',
        alignment: '1'
      };
      function showFeedback(id, val) {
        const fb = document.getElementById('feedback-' + id);
        fb.className = 'feedback ' + (val === expert[id] ? 'correct' : 'incorrect');
        fb.style.display = 'block';
      }
      function revealFinal() {
        document.getElementById('final').style.display = 'block';
        document.getElementById('proceedBtn').classList.remove('hidden');
        window.scrollTo(0,0);
      }
    </script>

    <!-- 1Ô∏è‚É£ Stem Clarity -->
    <div class="section">
      <h3>1Ô∏è‚É£ Stem Clarity</h3>
      <div class="rating-desc">
        <strong>Very Unclear:</strong> The stem is confusing, uses ambiguous, grammatically incorrect,<br>
        or inaccurate language, or negative constructs such as 'All are correct except,' which can lead to misunderstandings.<br>
        <strong>Somewhat Clear:</strong> The stem is generally understandable with minor ambiguities that could be improved for greater clarity and phrasing.<br>
        <strong>Very Clear:</strong> The stem is concise and communicates the question effectively.
      </div>
      <select onchange="showFeedback('clarity', this.value)">
        <option value="">-- Choose a rating --</option>
        <option value="1">1 - Very Unclear</option>
        <option value="2">2 - Somewhat Clear</option>
        <option value="3">3 - Very Clear</option>
      </select>
      <div id="feedback-clarity" class="feedback">
        <strong>Stem Clarity Feedback:</strong><br>
        The expert rated this stem <strong>3 (Very Clear)</strong>. The stem is concise and communicates the question effectively.
      </div>
    </div>

    <!-- 2Ô∏è‚É£ Correct Answer Accuracy -->
    <div class="section">
      <h3>2Ô∏è‚É£ Correct Answer Accuracy</h3>
      <div class="rating-desc">
        <strong>Incorrect:</strong> The provided answer fails to correctly address the question posed.<br>
        <strong>Partially Correct:</strong> The answer is mostly correct, though a more accurate option could be possible.<br>
        <strong>Fully Correct:</strong> The answer is correct and is the best choice among the options.
      </div>
      <select onchange="showFeedback('accuracy', this.value)">
        <option value="">-- Choose a rating --</option>
        <option value="1">1 - Incorrect</option>
        <option value="2">2 - Partially Correct</option>
        <option value="3">3 - Fully Correct</option>
      </select>
      <div id="feedback-accuracy" class="feedback">
        <strong>Answer Accuracy Feedback:</strong><br>
        The expert rated this answer <strong>3 (Fully Correct)</strong>.
      </div>
    </div>

    <!-- 3Ô∏è‚É£ Distractor Plausibility -->
    <div class="section">
      <h3>3Ô∏è‚É£ Distractor Plausibility</h3>
      <div class="rating-desc">
        <strong>Not Plausible:</strong> Distractors are obviously incorrect or irrelevant.<br>
        <strong>Somewhat Plausible:</strong> Distractors are somewhat plausible and present a moderate level of difficulty.<br>
        <strong>Very Plausible:</strong> All distractors are plausible options and provide a high level of difficulty.
      </div>
      <select onchange="showFeedback('distractors', this.value)">
        <option value="">-- Choose a rating --</option>
        <option value="1">1 - Not Plausible</option>
        <option value="2">2 - Somewhat Plausible</option>
        <option value="3">3 - Very Plausible</option>
      </select>
      <div id="feedback-distractors" class="feedback">
        <strong>Distractor Plausibility Feedback:</strong><br>
        The expert rated these distractors <strong>3 (Very Plausible)</strong>. These are all endocrine disorders and potential diagnoses.
      </div>
    </div>

    <!-- 4Ô∏è‚É£ Terminology -->
    <div class="section">
      <h3>4Ô∏è‚É£ Terminology</h3>
      <div class="rating-desc">
        <strong>Inaccurate:</strong> Uses incorrect or inconsistent terminology not aligned with the Test Plan.<br>
        <strong>Accurate:</strong> Consistently uses accurate terminology aligned with the Test Plan.
      </div>
      <select onchange="showFeedback('terminology', this.value)">
        <option value="">-- Choose a rating --</option>
        <option value="1">1 - Inaccurate</option>
        <option value="3">3 - Accurate</option>
      </select>
      <div id="feedback-terminology" class="feedback">
        <strong>Terminology Feedback:</strong><br>
        The expert rated this terminology <strong>1 (Inaccurate)</strong>.<br>
        <em>Explanation:</em> The question uses ‚Äúpatient‚Äù and the abbreviation ‚ÄúTSH‚Äù which could confuse test-takers.
        <div class="ref-box">
          <strong>Terminology Reference</strong><br>
          <table>
            <tr><th>Correct Term</th><th>Definition</th></tr>
            <tr><td>Client</td><td>Individual, family or group, which includes significant others and populations.</td></tr>
            <tr><td>Order</td><td>Intervention, remedy or treatment as directed by an authorized primary health care provider.</td></tr>
            <tr><td>Prescription</td><td>Intervention as it relates to medication specifically as directed by an authorized primary health care provider.</td></tr>
            <tr><td>Primary Health Care Provider</td><td>Members of the health care team who are licensed and authorized to formulate prescriptions and orders on behalf of the client.</td></tr>
            <tr><td>Unlicensed Assistive Personnel (UAP)</td><td>Any unlicensed personnel trained to function in a supportive role to whom a nursing responsibility may be delegated.</td></tr>
          </table>
          <p><strong>Incorrect Term ‚Üí Correct Term ‚Üí Reason</strong></p>
          <table>
            <tr><th>Incorrect</th><th>Correct</th><th>Reason for Avoidance</th></tr>
            <tr><td>q.d.</td><td>Daily</td><td>Can be confused for "QID" or "every day"</td></tr>
            <tr><td>U or u</td><td>Unit</td><td>Mistaken for zero or four, causing dosage errors</td></tr>
            <tr><td>IU</td><td>International Unit</td><td>Mistaken for intravenous or the number 10</td></tr>
            <tr><td>Q.O.D</td><td>Every other day</td><td>Mistaken for "QD" or "QID", which are very different dosing schedules</td></tr>
            <tr><td>Trailing zero (X.0 mg)</td><td>X mg</td><td>Trailing zero can lead to overdose if decimal is missed</td></tr>
            <tr><td>Lack of leading zero (.X mg)</td><td>0.X mg</td><td>Lack of leading zero can lead to overdose</td></tr>
          </table>
          <p><em>Disclaimer:</em> Abbreviations (including BP, HR, RR, etc) may confuse test-takers.</p>
        </div>
      </div>
    </div>

    <!-- 5Ô∏è‚É£ NCLEX Test Plan Alignment -->
    <div class="section">
      <h3>5Ô∏è‚É£ NCLEX Test Plan Alignment</h3>
      <div class="rating-desc">
        <strong>Not Aligned:</strong> The question does not align with one or more NCLEX-RN Test Plan activity statements.<br>
        <strong>Partially Aligned:</strong> The question has a superficial alignment with one or more NCLEX-RN Test Plan activity statements.<br>
        <strong>Fully Aligned:</strong> The question is fully aligned with one or more NCLEX-RN Test Plan activity statements.
      </div>
      <p>See the official NCLEX-RN Test Plan <a href="https://www.nclex.com/files/2023_RN_Test%20Plan_English_FINAL.pdf" target="_blank">here</a>.</p>
      <select onchange="showFeedback('alignment', this.value)">
        <option value="">-- Choose a rating --</option>
        <option value="1">1 - Not Aligned</option>
        <option value="2">2 - Partially Aligned</option>
        <option value="3">3 - Fully Aligned</option>
      </select>
      <div id="feedback-alignment" class="feedback">
        <strong>NCLEX Alignment Feedback:</strong><br>
        The expert rated this <strong>1 (Not Aligned)</strong> ‚Äî it is purely diagnostic, not a nursing action or priority.
      </div>
    </div>

    <!-- FINAL SCORE -->
    <div class="final-score">
      <button class="button" onclick="revealFinal()">üéØ Reveal Final Score</button>
      <div id="final" class="feedback hidden">
        <p><strong>Total Score: Low Quality</strong></p>
        <p>This question is clinically accurate but scores poorly because it misuses terminology and does not align with nursing scope or the NCLEX-RN Test Plan.</p>
      </div>
      <button id="proceedBtn" type="button" class="button hidden" onclick="finishWalkthrough()">Proceed to Questions</button>
    </div>
  </div>

  <!-- üîπ Assigned Forms Section (Hidden Until Walkthrough Done) -->
  <div id="surveySection" class="hidden">
    <h1>Your Assigned NCLEX Questions</h1>
    <p>Click the link below to begin. After completing a form, you will be automatically redirected to the next one.</p>
    <div id="links"></div>
  </div>

  <!-- üîπ Developer Mode Button -->
  <div class="dev-mode">
    <button class="button dev-button" onclick="enableDevMode()">Developer Mode: Reset</button>
  </div>

  <script>
    var formLinks = [
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion1",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion2",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion3",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion4",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion5",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion6",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion7",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion8",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion9",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion10",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion11",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion12",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion13",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion14",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion15",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion16",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion17",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion18",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion19",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion20",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion21",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion22",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion23",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion24",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion25",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion26",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion27",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion28",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion29",
      "https://www.cognitoforms.com/MGHIHP1/NEIAToolQuestion30"
    ];
    var numLinks = 5;
    function shuffle(a){
      let i = a.length, j, t;
      while(i){
        j = Math.floor(Math.random() * i--);
        t = a[i];
        a[i] = a[j];
        a[j] = t;
      }
      return a;
    }

    var hasConsented = localStorage.getItem("hasConsented"),
        walkthroughDone = localStorage.getItem("walkthroughDone"),
        completedForms = JSON.parse(localStorage.getItem("completedForms")) || [],
        stored = localStorage.getItem("savedLinks"),
        selectedLinks = stored
          ? JSON.parse(stored)
          : (function(){
              shuffle(formLinks);
              var s = formLinks.slice(0, numLinks);
              localStorage.setItem("savedLinks", JSON.stringify(s));
              return s;
            })();

    selectedLinks = selectedLinks.filter(function(l){
      return completedForms.indexOf(l) === -1;
    });

    if(hasConsented){
      document.getElementById("consentSection").style.display = "none";
      document.getElementById("walkthroughSection").classList.remove("hidden");
      if(walkthroughDone){
        document.getElementById("walkthroughSection").style.display = "none";
        document.getElementById("surveySection").classList.remove("hidden");
        renderNextLink();
      }
    }

    function startSurvey(){
      localStorage.setItem("hasConsented","true");
      document.getElementById("consentSection").style.display = "none";
      document.getElementById("walkthroughSection").classList.remove("hidden");
      window.scrollTo(0,0);
    }

    function finishWalkthrough(){
      localStorage.setItem("walkthroughDone","true");
      document.getElementById("walkthroughSection").style.display = "none";
      document.getElementById("surveySection").classList.remove("hidden");
      renderNextLink();
      window.scrollTo(0,0);
    }

    function renderNextLink(){
      var div = document.getElementById("links");
      if(selectedLinks.length === 0){
        div.innerHTML = "<h2>Thank you! You have completed all assigned forms.</h2>";
        return;
      }
      var next = selectedLinks[0];
      var a = document.createElement("a");
      a.href = next;
      a.target = "_self";
      a.innerText = "Click here to start your next question";
      a.onclick = function(){
        completedForms.push(next);
        localStorage.setItem("completedForms", JSON.stringify(completedForms));
      };
      div.appendChild(a);
    }

    function enableDevMode(){
      if(confirm("Clear all data?")){
        localStorage.clear();
        location.reload();
      }
    }
  </script>
</body>
</html>
